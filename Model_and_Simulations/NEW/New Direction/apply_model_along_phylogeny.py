
from model_application import apply_model_along_phylogeny

species_name = 'Bacillus_anthracis'
species_path = 'C:/Users/Owner/Documents/UNCG REU/Project/BIGG DATA/Useful Data/Concatenates, Trees, Homoplasies/Aayyy Clonal/Bacillus_anthracis/concat_universal.fa'
kappa = 1.86836732388
tree_string = '(B1:0.5,B2:0.5):0.0;'
# '(B57:0.00002151359142686458,((B64:0.00006483314614814997,B66:0.00006454379266932773):0.00000100000050002909,(B4:0.00006454799714257598,((B52:0.00000100000050002909,(B72:0.00006453932097448163,((B51:0.00011404214649481417,B7:0.00002306656980674110):0.00027392468655199569,((B34:0.00002151631167435291,(B9:0.00006876638896946039,B29:0.00000100000050002909):0.00004303591462261814):0.00002151545779588741,(B6:0.00006309001023541822,B15:0.00000100000050002909):0.00002816354086979557):0.00006455727289752973):0.00008610187140388709):0.00000100000050002909):0.00000100000050002909,(((((B83:0.00002151590565694596,B45:0.00008608415345512176):0.00002150992877216605,B21:0.00004303456006114923):0.00000100000050002909,B36:0.00004303177616292186):0.00000100000050002909,B84:0.00004343160055427527):0.00002150362950358651,(B89:0.00000100000050002909,B99:0.00008605580042589467):0.00015070795576246194):0.00000100000050002909):0.00002151096820486005):0.00000100000050002909):0.00002151386414347454,B58:0.00004303048201173684):0.0;'
# '(B57:0.00000536707125664551,((((B83:0.00002318173951070520,B45:0.00003365367407355436):0.00001970126751875890,(((B84:0.00000948118264665464,B99:0.00001914943883007716):0.00001143909786772645,(((B52:0.00005185110847249898,B89:0.00001633969855456498):0.00004537804571909241,B21:0.00011406645637562866):0.00001953691402093377,(B72:0.00008420804257297685,((B51:0.00008978912752602243,B7:0.00002287080714303825):0.00029324771986313119,((B34:0.00002730728276759067,(B9:0.00003316646850023659,B29:0.00002086920547771337):0.00008771969195870552):0.00002492360304559525,(B6:0.00000881808638051164,B15:0.00006370050086096601):0.00001778245864060021):0.00012946764031754985):0.00011766209279446951):0.00001247173836728674):0.00000100000050002909):0.00000844349545619994,B36:0.00002509526808151878):0.00000667150366752081):0.00009163824755429087,B4:0.00002332293862512587):0.00000616528362070958,(B66:0.00003411246880153140,B64:0.00003762063742532716):0.00000653195343569950):0.00001043697034630331,B58:0.00004497951428308054):0.0;'

output = apply_model_along_phylogeny(species_path, kappa, tree_string)
# strain_names = output['strain_names']
# c_matrix = output['Convergent']
# print(c_matrix)
print('here')

# shape = c_matrix.shape
# with open((species_name +'_c_matrix' + '.csv'), 'w', newline = '') as f: 
# 	writer = csv.writer(f)
# 	writer.writerow([species_name])
# 	header = ['']
# 	header.extend(strain_names)
# 	writer.writerow(header)
# 	for row in range(shape[0]):
# 		write_row = [strain_names[row]]
# 		write_row.extend(c_matrix[row])
# 		writer.writerow(write_row)